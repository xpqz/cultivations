
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Advanced OO techniques &#8212; APL Cultivations</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Complex numbers" href="Complex.html" />
    <link rel="prev" title="Inheritance and interfaces" href="Inheritance.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">APL Cultivations</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Intro.html">
   APL Cultivations
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Arrays.html">
   Introduction to arrays
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Functions.html">
   Primitive functions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions1.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       +-×÷*⍟⌹○
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions2.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       !?|⌈⌊⊥⊤⊣⊢
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions3.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       =≤&lt;&gt;≥≡≢
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions4.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       ∨∧⍱⍲↑↓
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions5.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       ⊂⊃⊆⌷⍋⍒
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions6.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       ⍳⍸∊⍷∪∩~
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions7.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       /\⌿⍀,⍪
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions8.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       ⍴⌽⊖⍉⍎⍕
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="UserFunctions.html">
   User-defined functions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Trains.html">
     Tacit programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Tradfns.html">
     Tradfns
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="SystemFunctions.html">
   System functions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Behaviour.html">
     Behaviour, session
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Constants.html">
     Constants, tools and utils
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="CodeManagement.html">
     Code management, I/O, dates, errors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="StackWorkspace.html">
     Stack and workspace info
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Regex.html">
     Regular expressions
     <code class="docutils literal notranslate">
      <span class="pre">
       ⎕R
      </span>
     </code>
     <code class="docutils literal notranslate">
      <span class="pre">
       ⎕S
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Operators.html">
   Primitive operators
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="InDepth.html">
   Deep dives
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Rank.html">
     Rank in depth
     <code class="docutils literal notranslate">
      <span class="pre">
       ⍤
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Power1.html">
     Power in depth:
     <code class="docutils literal notranslate">
      <span class="pre">
       f⍣k
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Power2.html">
     Power in depth:
     <code class="docutils literal notranslate">
      <span class="pre">
       f⍣g
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Decode.html">
     Decode in depth
     <code class="docutils literal notranslate">
      <span class="pre">
       ⊥
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Encode.html">
     Encode in depth
     <code class="docutils literal notranslate">
      <span class="pre">
       ⊤
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="ObjectOrientation.html">
   Object-oriented APL
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Namespaces.html">
     Namespaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ObjectsClasses.html">
     Objects and classes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="CtorsDtors.html">
     Constructors and destructors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Properties.html">
     Properties
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Inheritance.html">
     Inheritance and interfaces
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Advanced OO techniques
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Complex.html">
   Complex numbers
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/AdvancedOO.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/xpqz/cultivations"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/xpqz/cultivations/issues/new?title=Issue%20on%20page%20%2FAdvancedOO.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overriding-methods">
   Overriding methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#keyed-properties">
   Keyed properties
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numbered-properties">
   Numbered properties
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="advanced-oo-techniques">
<h1>Advanced OO techniques<a class="headerlink" href="#advanced-oo-techniques" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overriding-methods">
<h2>Overriding methods<a class="headerlink" href="#overriding-methods" title="Permalink to this headline">¶</a></h2>
<p>Overridable methods then. Dyalog borrows this terminology from Visual Basic. In C# and Java, they are referred to as “virtual methods”.</p>
<p>If a derived class defines a method that has the same name as a base class method, then that shadows the base class method (although the base class method remains callable with <code class="docutils literal notranslate"><span class="pre">⎕BASE.MyMethod</span></code>). However, if the derived class’ code calls a base class method which in turn calls a function by a name that has been defined both in the base class, and in the derived class, then it is the base class version that gets run. This is of course because the code that calls already is running in the base class. If in such a situation you want the derived class’ method to be called, then you need to <em>override</em> the base class method.</p>
<p>In order to do so, two conditions must be met:</p>
<ol class="simple">
<li><p>The base class method must declare itself to be overridable.</p></li>
<li><p>The derived class method must declare that it is overriding the base class method.</p></li>
</ol>
<p>Let’s look at an example. Here is a base class:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span>
<span class="bp">:</span><span class="nv">Class</span> <span class="nv">Base</span>
    <span class="bp">∇</span> <span class="nv">r</span><span class="kd">←</span><span class="nv">O</span>
      <span class="bp">:</span><span class="nv">Access</span> <span class="nv">Public</span> <span class="nv">Overridable</span>
      <span class="nv">r</span><span class="kd">←</span><span class="s1">&#39;O in Base&#39;</span>
    <span class="bp">∇</span>

    <span class="bp">∇</span> <span class="nv">r</span><span class="kd">←</span><span class="nv">F</span>
      <span class="bp">:</span><span class="nv">Access</span> <span class="nv">Public</span>
      <span class="nv">r</span><span class="kd">←</span><span class="s1">&#39;F in Base&#39;</span>
    <span class="bp">∇</span>

    <span class="bp">∇</span> <span class="nv">r</span><span class="kd">←</span><span class="nv">Caller</span>
      <span class="bp">:</span><span class="nv">Access</span> <span class="nv">Public</span>
      <span class="nv">r</span><span class="kd">←</span><span class="nv">O</span> <span class="nv">F</span>
    <span class="bp">∇</span>
<span class="bp">:</span><span class="nv">EndClass</span>
</pre></div>
</div>
</div>
</div>
<p>We have three methods. The two single letter methods just report when they’re called. <code class="docutils literal notranslate"><span class="pre">O</span></code> says it is overridable, <code class="docutils literal notranslate"><span class="pre">F</span></code> doesn’t. Then there is a <code class="docutils literal notranslate"><span class="pre">Caller</span></code> method which just calls the two single-letter methods.</p>
<p>Here is the companion derived class:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span>
<span class="bp">:</span><span class="nv">Class</span> <span class="nv">Derived</span> <span class="bp">:</span> <span class="nv">Base</span>
    <span class="bp">∇</span> <span class="nv">r</span><span class="kd">←</span><span class="nv">O</span>
      <span class="bp">:</span><span class="nv">Access</span> <span class="nv">Public</span> <span class="nv">Override</span>
      <span class="nv">r</span><span class="kd">←</span><span class="s1">&#39;O in Derived&#39;</span>
    <span class="bp">∇</span>

    <span class="bp">∇</span> <span class="nv">r</span><span class="kd">←</span><span class="nv">F</span>
      <span class="bp">:</span><span class="nv">Access</span> <span class="nv">Public</span>
      <span class="nv">r</span><span class="kd">←</span><span class="s1">&#39;F in Derived&#39;</span>
    <span class="bp">∇</span>
<span class="bp">:</span><span class="nv">EndClass</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">O</span></code> overrides the base <code class="docutils literal notranslate"><span class="pre">O</span></code>, but <code class="docutils literal notranslate"><span class="pre">F</span></code> doesn’t. If we call <code class="docutils literal notranslate"><span class="pre">Caller</span></code> from (an instance of) <code class="docutils literal notranslate"><span class="pre">Derived</span></code>, it will of course execute in the base class, but since <code class="docutils literal notranslate"><span class="pre">O</span></code> has been overridden, it will call the <code class="docutils literal notranslate"><span class="pre">O</span></code> in <code class="docutils literal notranslate"><span class="pre">Derived</span></code>, while <code class="docutils literal notranslate"><span class="pre">F</span></code> will just call the <code class="docutils literal notranslate"><span class="pre">F</span></code> in Base.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">I</span><span class="kd">←</span><span class="nf">⎕NEW</span> <span class="nv">Derived</span>
<span class="nv">I</span><span class="na">.</span><span class="nv">Caller</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌────────────┬─────────┐
│O in Derived│F in Base│
└────────────┴─────────┘
</span></div></div>
</div>
</div>
<div class="section" id="keyed-properties">
<h2>Keyed properties<a class="headerlink" href="#keyed-properties" title="Permalink to this headline">¶</a></h2>
<p>Let’s have a more in-depth look at properties, starting with <a class="reference external" href="http://help.dyalog.com/latest/index.htm#Language/Object%20Oriented%20Programming/Class%20Members/Properties/Keyed%20Properties.htm">keyed properties</a>. Normally, indexing is for numbers only, e.g. <code class="docutils literal notranslate"><span class="pre">vector[3</span> <span class="pre">1</span> <span class="pre">4]</span></code> and <code class="docutils literal notranslate"><span class="pre">matrix[3;1</span> <span class="pre">4]</span></code> etc. Sometimes you want an array-like thing where individual parts are identified by “keys” (usually character vectors).</p>
<p>For example, instead of referring to the individual columns of a database, you could refer to them by column name.
Instead of having to look up each customer ID to find its current row in the database, you’d want to refer to the rows by “name”, e.g. the customer ID. Keyed properties allow you to do so, but of course, you have to write the look-up code below the covers, in the property’s code.</p>
<p>As you can imagine, the possibilities are endless, but here is a general keyed property skeleton which tells you what the APL code sees:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span>
<span class="bp">:</span><span class="nv">Class</span> <span class="nv">ClassK</span>
    <span class="bp">:</span><span class="nv">Property</span> <span class="nv">Keyed</span> <span class="nv">K</span>
    <span class="bp">:</span><span class="nv">Access</span> <span class="nv">public</span> <span class="nv">shared</span>
        <span class="bp">∇</span> <span class="nv">r</span><span class="kd">←</span><span class="nv">Get</span> <span class="nv">x</span>
          <span class="vg">⎕</span><span class="kd">←</span><span class="nv">Show</span> <span class="nv">x</span>
          <span class="kd">→</span>
        <span class="bp">∇</span>

        <span class="bp">∇</span> <span class="nv">Set</span> <span class="nv">x</span>
          <span class="vg">⎕</span><span class="kd">←</span><span class="nv">Show</span> <span class="nv">x</span>
        <span class="bp">∇</span>
    <span class="bp">:</span><span class="nv">EndProperty</span>
    <span class="nv">Show</span><span class="kd">←</span><span class="kt">{</span><span class="bp">⍵</span><span class="na">.</span><span class="p">(</span><span class="o">↑</span><span class="kt">{</span><span class="bp">⍵</span><span class="p">(</span><span class="o">⍎</span><span class="bp">⍵</span><span class="p">)</span><span class="kt">}</span><span class="na">¨</span><span class="nf">⎕NL</span><span class="o">-⍳</span><span class="m">9</span><span class="p">)</span><span class="kt">}</span>
<span class="bp">:</span><span class="nv">EndClass</span>
</pre></div>
</div>
</div>
</div>
<p>You may remember the argument to the setter function from our first treatment of properties. It wasn’t very interesting then, but now it is of course critical. Also, note that the getter function now takes an argument. This is because we cannot just return the value of the property; we need to return the correct particular value using the keys.</p>
<p>For now, each function just calls <code class="docutils literal notranslate"><span class="pre">Show</span></code> which is a little, hacky, function that creates a visual representation of the argument; a two-column matrix of variable names and their values. The getter also has <code class="docutils literal notranslate"><span class="pre">→</span></code> to force quit instead of actually returning something. This is to avoid having to generate some data which conforms to the shape of the request.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">ClassK</span><span class="na">.</span><span class="nv">K</span><span class="sr">[</span><span class="o">⊂</span><span class="s1">&#39;Abe&#39;</span><span class="sr">]</span><span class="kd">←</span><span class="o">⊂</span><span class="m">2</span> <span class="m">5</span><span class="o">⍴</span><span class="nf">⎕A</span>
<span class="nv">ClassK</span><span class="na">.</span><span class="nv">K</span><span class="sr">[</span><span class="s1">&#39;Abe&#39;</span> <span class="s1">&#39;Bob&#39;</span><span class="sr">]</span><span class="kd">←</span><span class="m">3</span> <span class="m">14</span>
<span class="nv">ClassK</span><span class="na">.</span><span class="nv">K</span><span class="sr">[</span><span class="s1">&#39;Abe&#39;</span> <span class="s1">&#39;Bob&#39;</span><span class="sr">;</span><span class="s1">&#39;Name&#39;</span> <span class="s1">&#39;Age&#39;</span><span class="sr">]</span><span class="kd">←</span><span class="m">2</span> <span class="m">2</span><span class="o">⍴</span><span class="s1">&#39;Abraham&#39;</span> <span class="m">3</span>  <span class="s1">&#39;Robert&#39;</span> <span class="m">14</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────────────────┬───────┐
│Indexers         │┌─────┐│
│                 ││┌───┐││
│                 │││Abe│││
│                 ││└───┘││
│                 │└─────┘│
├─────────────────┼───────┤
│IndexersSpecified│1      │
├─────────────────┼───────┤
│Name             │K      │
├─────────────────┼───────┤
│NewValue         │┌─────┐│
│                 ││ABCDE││
│                 ││FGHIJ││
│                 │└─────┘│
└─────────────────┴───────┘
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────────────────┬───────────┐
│Indexers         │┌─────────┐│
│                 ││┌───┬───┐││
│                 │││Abe│Bob│││
│                 ││└───┴───┘││
│                 │└─────────┘│
├─────────────────┼───────────┤
│IndexersSpecified│1          │
├─────────────────┼───────────┤
│Name             │K          │
├─────────────────┼───────────┤
│NewValue         │3 14       │
└─────────────────┴───────────┘
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────────────────┬──────────────────────┐
│Indexers         │┌─────────┬──────────┐│
│                 ││┌───┬───┐│┌────┬───┐││
│                 │││Abe│Bob│││Name│Age│││
│                 ││└───┴───┘│└────┴───┘││
│                 │└─────────┴──────────┘│
├─────────────────┼──────────────────────┤
│IndexersSpecified│1 1                   │
├─────────────────┼──────────────────────┤
│Name             │K                     │
├─────────────────┼──────────────────────┤
│NewValue         │┌───────┬──┐          │
│                 ││Abraham│3 │          │
│                 │├───────┼──┤          │
│                 ││Robert │14│          │
│                 │└───────┴──┘          │
└─────────────────┴──────────────────────┘
</span></div></div>
</div>
<p>Notice that keyed properties do not have any particular rank. The first two assignments treat <code class="docutils literal notranslate"><span class="pre">K</span></code> like it’s a vector, while the last one treats it as a matrix. APL does check that the indexers and the new values conform according to the rules of scalar extension.</p>
<p>Getting is exactly the same, except that the argument namespace does not have a <code class="docutils literal notranslate"><span class="pre">NewValue</span></code> member:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">ClassK</span><span class="na">.</span><span class="nv">K</span><span class="sr">[</span><span class="o">⊂</span><span class="s1">&#39;Abe&#39;</span><span class="sr">]</span>
<span class="nv">ClassK</span><span class="na">.</span><span class="nv">K</span><span class="sr">[</span><span class="s1">&#39;Abe&#39;</span> <span class="s1">&#39;Bob&#39;</span><span class="sr">]</span>
<span class="nv">ClassK</span><span class="na">.</span><span class="nv">K</span><span class="sr">[</span><span class="s1">&#39;Abe&#39;</span> <span class="s1">&#39;Bob&#39;</span><span class="sr">;</span><span class="s1">&#39;Name&#39;</span> <span class="s1">&#39;Age&#39;</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────────────────┬───────┐
│Indexers         │┌─────┐│
│                 ││┌───┐││
│                 │││Abe│││
│                 ││└───┘││
│                 │└─────┘│
├─────────────────┼───────┤
│IndexersSpecified│1      │
├─────────────────┼───────┤
│Name             │K      │
└─────────────────┴───────┘
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────────────────┬───────────┐
│Indexers         │┌─────────┐│
│                 ││┌───┬───┐││
│                 │││Abe│Bob│││
│                 ││└───┴───┘││
│                 │└─────────┘│
├─────────────────┼───────────┤
│IndexersSpecified│1          │
├─────────────────┼───────────┤
│Name             │K          │
└─────────────────┴───────────┘
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────────────────┬──────────────────────┐
│Indexers         │┌─────────┬──────────┐│
│                 ││┌───┬───┐│┌────┬───┐││
│                 │││Abe│Bob│││Name│Age│││
│                 ││└───┴───┘│└────┴───┘││
│                 │└─────────┴──────────┘│
├─────────────────┼──────────────────────┤
│IndexersSpecified│1 1                   │
├─────────────────┼──────────────────────┤
│Name             │K                     │
└─────────────────┴──────────────────────┘
</span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span>
<span class="bp">:</span><span class="nv">Class</span> <span class="nv">Database</span>
    <span class="bp">:</span><span class="nv">Field</span> <span class="nv">public</span> <span class="nv">DB</span><span class="kd">←</span><span class="m">0</span> <span class="m">3</span><span class="o">⍴</span><span class="s1">&#39;&#39;</span> <span class="s1">&#39;&#39;</span> <span class="m">0</span>
    <span class="bp">:</span><span class="nv">Property</span> <span class="nv">Keyed</span> <span class="nv">K</span>
    <span class="bp">:</span><span class="nv">Access</span> <span class="nv">public</span>
        <span class="bp">∇</span> <span class="nv">r</span><span class="kd">←</span><span class="nv">Get</span> <span class="nv">x</span>
          <span class="p">(</span><span class="nv">id</span> <span class="nv">col</span><span class="p">)</span><span class="kd">←</span><span class="nv">x</span><span class="na">.</span><span class="nv">Indexers</span>
          <span class="bp">:</span><span class="nv">If</span> <span class="nv">id</span><span class="o">∊</span><span class="nv">DB</span><span class="sr">[;</span><span class="m">1</span><span class="sr">]</span>
              <span class="nv">r</span><span class="kd">←</span><span class="nv">DB</span><span class="sr">[</span><span class="nv">DB</span><span class="sr">[;</span><span class="m">1</span><span class="sr">]</span><span class="o">⍳</span><span class="nv">id</span><span class="sr">;</span><span class="s1">&#39;id&#39;</span> <span class="s1">&#39;name&#39;</span> <span class="s1">&#39;age&#39;</span><span class="o">⍳</span><span class="nv">col</span><span class="sr">]</span>
          <span class="bp">:</span><span class="nv">Else</span>
              <span class="nf">⎕SIGNAL</span> <span class="m">6</span> <span class="c1">⍝ value error</span>
          <span class="bp">:</span><span class="nv">EndIf</span>
        <span class="bp">∇</span>

        <span class="bp">∇</span> <span class="nv">Set</span> <span class="nv">x</span><span class="sr">;</span><span class="nv">id</span><span class="sr">;</span><span class="nv">col</span>
          <span class="p">(</span><span class="nv">id</span> <span class="nv">col</span><span class="p">)</span><span class="kd">←</span><span class="nv">x</span><span class="na">.</span><span class="nv">Indexers</span>
          <span class="bp">:</span><span class="nv">If</span> <span class="nv">id</span><span class="o">∊</span><span class="nv">DB</span><span class="sr">[;</span><span class="m">1</span><span class="sr">]</span>
              <span class="nv">DB</span><span class="sr">[</span><span class="nv">DB</span><span class="sr">[;</span><span class="m">1</span><span class="sr">]</span><span class="o">⍳</span><span class="nv">id</span><span class="sr">;</span><span class="s1">&#39;id&#39;</span> <span class="s1">&#39;name&#39;</span> <span class="s1">&#39;age&#39;</span><span class="o">⍳</span><span class="nv">col</span><span class="sr">]</span><span class="kd">←</span><span class="nv">x</span><span class="na">.</span><span class="nv">NewValue</span>
          <span class="bp">:</span><span class="nv">Else</span>
              <span class="nv">DB</span><span class="o">⍪</span><span class="kd">←</span><span class="nv">id</span><span class="o">,</span><span class="nv">x</span><span class="na">.</span><span class="nv">NewValue</span>
          <span class="bp">:</span><span class="nv">EndIf</span>
        <span class="bp">∇</span>
    <span class="bp">:</span><span class="nv">EndProperty</span>
    <span class="nv">Show</span><span class="kd">←</span><span class="kt">{</span><span class="bp">⍵</span><span class="na">.</span><span class="p">(</span><span class="o">↑</span><span class="kt">{</span><span class="bp">⍵</span><span class="p">(</span><span class="o">⍎</span><span class="bp">⍵</span><span class="p">)</span><span class="kt">}</span><span class="na">¨</span><span class="nf">⎕NL</span><span class="o">-⍳</span><span class="m">9</span><span class="p">)</span><span class="kt">}</span>
<span class="bp">:</span><span class="nv">EndClass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">i</span><span class="kd">←</span><span class="nf">⎕NEW</span> <span class="nv">Database</span>
<span class="nv">i</span><span class="na">.</span><span class="nv">K</span><span class="sr">[</span><span class="o">⊂</span><span class="s1">&#39;Dave&#39;</span><span class="sr">;</span><span class="s1">&#39;name&#39;</span> <span class="s1">&#39;age&#39;</span><span class="sr">]</span><span class="kd">←</span><span class="s1">&#39;David&#39;</span> <span class="m">31</span>
<span class="nv">i</span><span class="na">.</span><span class="nv">K</span><span class="sr">[</span><span class="o">⊂</span><span class="s1">&#39;Ernie&#39;</span><span class="sr">;</span><span class="s1">&#39;name&#39;</span> <span class="s1">&#39;age&#39;</span><span class="sr">]</span><span class="kd">←</span><span class="s1">&#39;Ernie&#39;</span> <span class="m">28</span>
<span class="nv">i</span><span class="na">.</span><span class="nv">K</span><span class="sr">[</span><span class="o">⊂</span><span class="s1">&#39;Dave&#39;</span><span class="sr">;</span><span class="s1">&#39;name&#39;</span> <span class="s1">&#39;age&#39;</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌─────┬──┐
│David│31│
└─────┴──┘
</span></div></div>
</div>
</div>
<div class="section" id="numbered-properties">
<h2>Numbered properties<a class="headerlink" href="#numbered-properties" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference external" href="http://help.dyalog.com/latest/index.htm#Language/Object%20Oriented%20Programming/Class%20Members/Properties/Numbered%20Properties.htm">numbered property</a> behaves like an array (conceptually a vector) which is only ever partially accessed and set (one element at a time) via indices. Here’s an example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span>
<span class="bp">:</span><span class="nv">Class</span> <span class="nv">ClassN</span>
    <span class="bp">:</span><span class="nv">Property</span> <span class="nv">Numbered</span> <span class="nv">N</span>
    <span class="bp">:</span><span class="nv">Access</span> <span class="nv">public</span> <span class="nv">shared</span>
        <span class="bp">∇</span> <span class="nv">r</span><span class="kd">←</span><span class="nv">Get</span> <span class="nv">x</span>
          <span class="vg">⎕</span><span class="kd">←</span><span class="nv">Show</span> <span class="nv">x</span>
          <span class="kd">→</span>
        <span class="bp">∇</span>

        <span class="bp">∇</span> <span class="nv">Set</span> <span class="nv">x</span>
          <span class="vg">⎕</span><span class="kd">←</span><span class="nv">Show</span> <span class="nv">x</span>
        <span class="bp">∇</span>

        <span class="bp">∇</span> <span class="nv">r</span><span class="kd">←</span><span class="nv">Shape</span>
          <span class="nv">r</span><span class="kd">←</span><span class="m">2</span> <span class="m">3</span>
        <span class="bp">∇</span>
    <span class="bp">:</span><span class="nv">EndProperty</span>
    <span class="nv">Show</span><span class="kd">←</span><span class="kt">{</span><span class="bp">⍵</span><span class="na">.</span><span class="p">(</span><span class="o">↑</span><span class="kt">{</span><span class="bp">⍵</span><span class="p">(</span><span class="o">⍎</span><span class="bp">⍵</span><span class="p">)</span><span class="kt">}</span><span class="na">¨</span><span class="nf">⎕NL</span><span class="o">-⍳</span><span class="m">9</span><span class="p">)</span><span class="kt">}</span>
<span class="bp">:</span><span class="nv">EndClass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">ClassN</span><span class="na">.</span><span class="nv">N</span><span class="sr">[</span><span class="m">1</span><span class="sr">;</span><span class="m">2</span> <span class="m">3</span><span class="sr">]</span><span class="kd">←</span><span class="s1">&#39;ab&#39;</span>
<span class="nv">ClassN</span><span class="na">.</span><span class="nv">N</span><span class="sr">[</span><span class="m">1</span><span class="sr">;</span><span class="m">2</span> <span class="m">3</span><span class="sr">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌────────┬─────┐
│Indexers│┌───┐│
│        ││1 2││
│        │└───┘│
├────────┼─────┤
│Name    │N    │
├────────┼─────┤
│NewValue│a    │
└────────┴─────┘
┌────────┬─────┐
│Indexers│┌───┐│
│        ││1 3││
│        │└───┘│
├────────┼─────┤
│Name    │N    │
├────────┼─────┤
│NewValue│b    │
└────────┴─────┘
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">┌────────┬─────┐
│Indexers│┌───┐│
│        ││1 2││
│        │└───┘│
├────────┼─────┤
│Name    │N    │
└────────┴─────┘
</span></div></div>
</div>
<p>It looks very much like our first keyed example, but there is an additional <code class="docutils literal notranslate"><span class="pre">Shape</span></code> function which allows APL to know what this imaginary array looks like. Also, note that the setter (and for that sake the getter) gets called once for each element that needs to be set (or retrieved).</p>
<p>Using this, you implement a sparse array in much the same way as we did the database. Basically, you’d make a 2-column table of indices and values, and then look up any requested index in the first column to find the corresponding value in the right column. When setting, we’d again look whether the index is already used, and then overwrite that, or if not found, add an entry to our “database”. This index lookup can be made very performant by means of a <a class="reference external" href="https://help.dyalog.com/latest/#Language/I%20Beam%20Functions/Hash%20Array.htm">hashed array</a>, <code class="docutils literal notranslate"><span class="pre">1500⌶</span></code>.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "dyalog-kernel"
        },
        kernelOptions: {
            kernelName: "dyalog-kernel",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'dyalog-kernel'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="Inheritance.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Inheritance and interfaces</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Complex.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Complex numbers</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Adám Brudzewsky (edited by Stefan Kruger)<br/>
        
          <div class="extra_footer">
            <p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" />
</a></p>
<p>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>