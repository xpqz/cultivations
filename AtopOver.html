
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Atop and Over in depth ⍤⍥ &#8212; APL Cultivations</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Object-oriented APL" href="ObjectOrientation.html" />
    <link rel="prev" title="Variant in depth ⍠" href="Variant.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">APL Cultivations</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Intro.html">
   APL Cultivations
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Arrays.html">
   Introduction to arrays
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Functions.html">
   Primitive functions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions1.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       +-×÷*⍟⌹○
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions2.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       !?|⌈⌊⊥⊤⊣⊢
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions3.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       =≤&lt;&gt;≥≡≢
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions4.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       ∨∧⍱⍲↑↓
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions5.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       ⊂⊃⊆⌷⍋⍒
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions6.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       ⍳⍸∊⍷∪∩~
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions7.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       /\⌿⍀,⍪
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Functions8.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       ⍴⌽⊖⍉⍎⍕
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="UserFunctions.html">
   User-defined functions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Trains.html">
     Tacit programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Tradfns.html">
     Tradfns
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="SystemFunctions.html">
   System functions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Behaviour.html">
     Behaviour, session
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Constants.html">
     Constants, tools and utils
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="CodeManagement.html">
     Code management, I/O, dates, errors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="StackWorkspace.html">
     Stack and workspace info
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Regex.html">
     Regular expressions
     <code class="docutils literal notranslate">
      <span class="pre">
       ⎕R
      </span>
     </code>
     <code class="docutils literal notranslate">
      <span class="pre">
       ⎕S
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Operators.html">
   Primitive operators
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="InDepth.html">
   Deep dives
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Rank.html">
     Rank in depth
     <code class="docutils literal notranslate">
      <span class="pre">
       ⍤
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Power1.html">
     Power in depth:
     <code class="docutils literal notranslate">
      <span class="pre">
       f⍣k
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Power2.html">
     Power in depth:
     <code class="docutils literal notranslate">
      <span class="pre">
       f⍣g
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Decode.html">
     Decode in depth
     <code class="docutils literal notranslate">
      <span class="pre">
       ⊥
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Encode.html">
     Encode in depth
     <code class="docutils literal notranslate">
      <span class="pre">
       ⊤
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Variant.html">
     Variant in depth
     <code class="docutils literal notranslate">
      <span class="pre">
       ⍠
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Atop and Over in depth
     <code class="docutils literal notranslate">
      <span class="pre">
       ⍤⍥
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="ObjectOrientation.html">
   Object-oriented APL
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Namespaces.html">
     Namespaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ObjectsClasses.html">
     Objects and classes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="CtorsDtors.html">
     Constructors and destructors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Properties.html">
     Properties
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Inheritance.html">
     Inheritance and interfaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="AdvancedOO.html">
     Advanced OO techniques
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Complex.html">
   Complex numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CountingWords.html">
   Counting words, faster
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="PDI.html">
   Lookup without replacement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="UserCommands.html">
   User commands
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/AtopOver.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/xpqz/cultivations"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/xpqz/cultivations/issues/new?title=Issue%20on%20page%20%2FAtopOver.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atop-fg">
   Atop
   <code class="docutils literal notranslate">
    <span class="pre">
     f⍤g
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#over">
   Over
   <code class="docutils literal notranslate">
    <span class="pre">
     ⍥
    </span>
   </code>
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="atop-and-over-in-depth">
<h1>Atop and Over in depth <code class="docutils literal notranslate"><span class="pre">⍤⍥</span></code><a class="headerlink" href="#atop-and-over-in-depth" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="http://help.dyalog.com/latest/index.htm#Language/Primitive%20Operators/Atop.htm">Atop</a>, <code class="docutils literal notranslate"><span class="pre">⍤</span></code>, and <a class="reference external" href="http://help.dyalog.com/latest/index.htm#Language/Primitive%20Operators/Over.htm">Over</a>, <code class="docutils literal notranslate"><span class="pre">⍥</span></code>, are compositional operators recently added to Dyalog.</p>
<div class="section" id="atop-fg">
<h2>Atop <code class="docutils literal notranslate"><span class="pre">f⍤g</span></code><a class="headerlink" href="#atop-fg" title="Permalink to this headline">¶</a></h2>
<p>First atop, which has been assigned <code class="docutils literal notranslate"><span class="pre">function⍤function</span></code> thus sharing the symbol with the <a class="reference external" href="http://help.dyalog.com/latest/index.htm#Language/Primitive%20Operators/Rank.htm">rank</a> operator’s <code class="docutils literal notranslate"><span class="pre">function⍤array</span></code>. You may be familiar with the 2-train, which is also called “atop”: <code class="docutils literal notranslate"><span class="pre">(f</span> <span class="pre">g)Y</span></code> and <code class="docutils literal notranslate"><span class="pre">X(f</span> <span class="pre">g)Y</span></code>. Maybe you’ve even been burned by <code class="docutils literal notranslate"><span class="pre">f∘g</span> <span class="pre">Y</span></code> being an atop, but <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">f∘g</span> <span class="pre">Y</span></code> <em>not</em> being an atop. Well, the atop operator is what you would expect. In other words, <code class="docutils literal notranslate"><span class="pre">f⍤g</span> <span class="pre">Y</span></code> is exactly like <code class="docutils literal notranslate"><span class="pre">f∘g</span> <span class="pre">Y</span></code> but <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">f⍤g</span> <span class="pre">Y</span></code> is <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">X</span> <span class="pre">g</span> <span class="pre">Y</span></code> or <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">(f</span> <span class="pre">g)</span> <span class="pre">Y</span></code>. We strongly recommend transitioning to use <code class="docutils literal notranslate"><span class="pre">⍤</span></code> in places where you’ve hitherto used monadic <code class="docutils literal notranslate"><span class="pre">f∘g</span></code>: it will prevent (at least one potential cause of) frustration if you ever decide to add a left argument to your code.</p>
<p>Here’s an example of what can happen. Let’s say you define a function that returns the magnitude of reciprocal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">|</span><span class="na">∘</span><span class="o">÷</span> <span class="m">¯4</span>
<span class="o">|</span><span class="na">∘</span><span class="o">÷</span> <span class="m">¯5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.25
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">0.2
</span></div></div>
</div>
<p>(This could, of course, be written without the <code class="docutils literal notranslate"><span class="pre">∘</span></code> but we’ve opted for a very simple function for illustration purposes). Now you get a feature request that the function should take a left argument which is a numerator (instead of the default 1).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span> <span class="o">|</span><span class="na">∘</span><span class="o">÷</span> <span class="m">¯4</span>
<span class="m">2</span> <span class="o">|</span><span class="na">∘</span><span class="o">÷</span> <span class="m">¯5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">1.75
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">1.8
</span></div></div>
</div>
<p>Oops. However:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">|</span><span class="na">⍤</span><span class="o">÷</span> <span class="m">¯4</span>
<span class="o">|</span><span class="na">⍤</span><span class="o">÷</span> <span class="m">¯5</span>
<span class="m">2</span> <span class="o">|</span><span class="na">⍤</span><span class="o">÷</span> <span class="m">¯4</span>
<span class="m">2</span> <span class="o">|</span><span class="na">⍤</span><span class="o">÷</span> <span class="m">¯5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">0.25
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">0.2
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">0.5
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">0.4
</span></div></div>
</div>
<p>One way to look at <code class="docutils literal notranslate"><span class="pre">f∘g</span></code> vs <code class="docutils literal notranslate"><span class="pre">f⍤g</span></code> is that when given a left argument, <code class="docutils literal notranslate"><span class="pre">∘</span></code> gives it to the left-hand function and <code class="docutils literal notranslate"><span class="pre">⍤</span></code> gives it to the right-hand function. Other than that, they are equivalent. Another way to look at <code class="docutils literal notranslate"><span class="pre">f∘g</span></code> vs <code class="docutils literal notranslate"><span class="pre">f⍤g</span></code> is simply choosing order of the first two tokens in the equivalent explicit expression: <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">f∘g</span> <span class="pre">Y</span></code> computes <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">f</span> <span class="pre">g</span> <span class="pre">Y</span></code> and <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">f⍤g</span> <span class="pre">Y</span></code> computes <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">X</span> <span class="pre">g</span> <span class="pre">Y</span></code>. So we’re simply swapping <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
<p>Then there’s the classic problem with slashes, especially in tacit programming. If you’ve ever tried using replicate/compress in a train, you’ll have bumped into the fact that slashes prefer being operators over being functions. This means that <code class="docutils literal notranslate"><span class="pre">{(5&lt;⍵)/⍵}</span></code> <em>doesn’t</em> convert to <code class="docutils literal notranslate"><span class="pre">(5&lt;⊢)/⊢</span></code>.</p>
<p>Whilst it may not be obvious at first sight, if we define <code class="docutils literal notranslate"><span class="pre">f←5&lt;⊢</span></code> it might become clearer that <code class="docutils literal notranslate"><span class="pre">f/⊢</span></code> isn’t at all what we want. Now, there’s an axiom in APL that an operator cannot be an operand (shh, don’t mention <code class="docutils literal notranslate"><span class="pre">∘.f</span></code>). This means that if a slash ends up in a situation where it has to be an operand, it will resort to being a function. You may even have noticed that constructs like <code class="docutils literal notranslate"><span class="pre">⊢(/⍨)5&lt;⊢</span></code> work fine, but <code class="docutils literal notranslate"><span class="pre">⊢/⍨5&lt;⊢</span></code> doesn’t. This is because the <code class="docutils literal notranslate"><span class="pre">/</span></code> in isolation with the <code class="docutils literal notranslate"><span class="pre">⍨</span></code> is forced to become the operand of <code class="docutils literal notranslate"><span class="pre">⍨</span></code>. But since operators bind from the left, <code class="docutils literal notranslate"><span class="pre">⊢/</span></code> binds first, and so <code class="docutils literal notranslate"><span class="pre">⊢/⍨5&lt;⊢</span></code> becomes <code class="docutils literal notranslate"><span class="pre">(⊢/)⍨5&lt;⊢</span></code> or <code class="docutils literal notranslate"><span class="pre">(5&lt;⊢)⊢/(5&lt;⊢)</span></code> which is usually not what you want.</p>
<p>So, <code class="docutils literal notranslate"><span class="pre">⍤</span></code> to the rescue.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">⍤</span></code> (or any dyadic operator) is found to the immediate left of a slash, then clearly the dyadic operator cannot be the operand of the slash, <code class="docutils literal notranslate"><span class="pre">⍤</span></code> being a dyadic operator itself, and it can’t be part of the function on the left, since it requires a right-operand, too. Therefore, the slash is forced to become a function.</p>
<p>So <code class="docutils literal notranslate"><span class="pre">-⍤/</span></code> is the negation of the replicate:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">0</span> <span class="m">2</span><span class="o">-</span><span class="na">⍤/</span><span class="m">10</span> <span class="m">20</span> <span class="m">30</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯10 ¯30 ¯30
</span></div></div>
</div>
<p>It is easy to think then that “oh, this is an atop, so I should be able to do this with parentheses too; <code class="docutils literal notranslate"><span class="pre">(f</span> <span class="pre">g)</span></code>” but that’d be a mistake: <code class="docutils literal notranslate"><span class="pre">(-/)</span></code> is just a normal minus-reduction. Another mistake is to think: “if a slash is an operand, it’ll be a function” and then think that <code class="docutils literal notranslate"><span class="pre">/∘⊢</span></code> would work like <code class="docutils literal notranslate"><span class="pre">⊢⍤/</span></code> by pre-processing the right argument with a no-op rather than post-processing the result with a no-op.</p>
<p>Let’s say we want a function <code class="docutils literal notranslate"><span class="pre">Apply</span></code> which takes an argument consisting of two vectors; a mask and some data, and computes <code class="docutils literal notranslate"><span class="pre">mask/data</span></code>. It isn’t sufficient to write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">Apply</span> <span class="kd">←</span> <span class="na">//</span> <span class="c1">⍝ Incorrect; returns an enclosed result</span>
</pre></div>
</div>
</div>
</div>
<p>Instead, we can write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">Apply</span> <span class="kd">←</span> <span class="o">⊃⊢</span><span class="na">⍤//</span>
</pre></div>
</div>
</div>
</div>
<p>In fact, once <code class="docutils literal notranslate"><span class="pre">⊢⍤/</span></code> becomes more established as a common pattern, you can actually help the reader of your code by using <code class="docutils literal notranslate"><span class="pre">⊢⍤/</span></code> so they don’t have to consider if your slash is replicate or reduce. For example, if your code says <code class="docutils literal notranslate"><span class="pre">z←x/y</span></code> it might not be obvious what’s going on. If you instead write <code class="docutils literal notranslate"><span class="pre">z←x⊢⍤/y</span></code> your reader knows exactly what you’re doing.</p>
<p>Another somewhat contrived example: given an array, replace every element with two copies of itself prefixed and suffixed by the relevant prototypal element. E.g. <code class="docutils literal notranslate"><span class="pre">'abc'</span></code> becomes <code class="docutils literal notranslate"><span class="pre">'</span> <span class="pre">aa</span>&#160; <span class="pre">bb</span>&#160; <span class="pre">cc</span> <span class="pre">'</span></code>.  <code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">20</span> <span class="pre">30</span></code> should become <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">10</span> <span class="pre">10</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">20</span> <span class="pre">20</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">30</span> <span class="pre">30</span> <span class="pre">0</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">f</span> <span class="kd">←</span> <span class="o">⊢⊢</span><span class="na">⍤⍀⍨</span><span class="m">0</span> <span class="m">2</span> <span class="m">0</span><span class="o">⍴</span><span class="na">⍨</span><span class="m">3</span><span class="o">×≢</span>
<span class="sr">]</span><span class="nv">display</span> <span class="nv">f</span> <span class="s1">&#39;abc&#39;</span>
<span class="nv">f</span> <span class="m">10</span> <span class="m">20</span> <span class="m">30</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">┌→───────────┐
│ aa  bb  cc │
└────────────┘
</span></div><div class="output text_html"><span style="white-space:pre; font-family: monospace">0 10 10 0 0 20 20 0 0 30 30 0
</span></div></div>
</div>
<p>Note how we force <code class="docutils literal notranslate"><span class="pre">⍀</span></code> into a function by saying <code class="docutils literal notranslate"><span class="pre">⊢⍤⍀</span></code> in the train.</p>
</div>
<div class="section" id="over">
<h2>Over <code class="docutils literal notranslate"><span class="pre">⍥</span></code><a class="headerlink" href="#over" title="Permalink to this headline">¶</a></h2>
<p>Remember how <code class="docutils literal notranslate"><span class="pre">f∘g</span></code> pre-processes the right argument of <code class="docutils literal notranslate"><span class="pre">f</span></code> using <code class="docutils literal notranslate"><span class="pre">g</span></code>? One way to look at <a class="reference external" href="http://help.dyalog.com/latest/index.htm#Language/Primitive%20Operators/Over.htm">Over</a> is simply as preprocessing <em>all</em> arguments of <code class="docutils literal notranslate"><span class="pre">f</span></code> using <code class="docutils literal notranslate"><span class="pre">g</span></code>. All, as in both or the only. So, again <code class="docutils literal notranslate"><span class="pre">f⍥g</span> <span class="pre">Y</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">f⍤g</span> <span class="pre">Y</span></code> and <code class="docutils literal notranslate"><span class="pre">f∘g</span> <span class="pre">Y</span></code>. The difference is, again, when we do a dyadic application. While <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">f∘g</span> <span class="pre">Y</span></code> is <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">f(g</span> <span class="pre">Y)</span></code> we have <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">f⍥g</span> <span class="pre">Y</span></code> be <code class="docutils literal notranslate"><span class="pre">(g</span> <span class="pre">X)f(g</span> <span class="pre">Y)</span></code>. This may seem like an overly involved operator, but really, the pattern of pre-processing both arguments comes up a lot. Once you start looking for it, you’ll see it all over.</p>
<p>For example, write a dyadic function computing the sum of absolute values of its arguments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">¯5</span> <span class="o">+</span><span class="na">⍥</span><span class="o">|</span> <span class="m">23</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">28
</span></div></div>
</div>
<p>Compare that to the old-fashioned <code class="docutils literal notranslate"><span class="pre">+/∘|</span></code>, or even <code class="docutils literal notranslate"><span class="pre">⊃(+/∘|{⍺⍵})</span></code>. Another: given arguments which are vectors, which one has the smallest maximum? Return ¯1 if the left argument has the smallest maximum, 1 if the right one has, or 0 if they are equal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">0</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="o">×</span><span class="na">⍤</span><span class="o">-</span><span class="na">⍥</span><span class="p">(</span><span class="o">⌈</span><span class="na">/</span><span class="p">)</span> <span class="m">7</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">8</span> <span class="m">6</span> <span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">¯1
</span></div></div>
</div>
<p>OK, how about this: write an alternative to replicate which can take arguments of equal shape, both with rank greater than 1, and replicates the corresponding elements. Since the result might otherwise be ragged, you have to return a vector.</p>
<div class="highlight-apl notranslate"><div class="highlight"><pre><span></span>      <span class="p">(</span><span class="m">2</span> <span class="m">3</span><span class="o">⍴⍳</span><span class="m">6</span><span class="p">)</span> <span class="nv">YourFunction</span> <span class="m">2</span> <span class="m">3</span><span class="o">⍴</span><span class="nf">⎕A</span>
<span class="nv">ABBCCCDDDDEEEEEFFFFFF</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="m">2</span> <span class="m">3</span><span class="o">⍴⍳</span><span class="m">6</span><span class="p">)</span> <span class="o">⊢</span><span class="na">⍤/⍥</span><span class="o">,</span> <span class="m">2</span> <span class="m">3</span><span class="o">⍴</span><span class="nf">⎕A</span> <span class="c1">⍝ Replicate over catenate</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style="white-space:pre; font-family: monospace">ABBCCCDDDDEEEEEFFFFFF
</span></div></div>
</div>
<p>In this case, you don’t <em>need</em> <code class="docutils literal notranslate"><span class="pre">⊢⍤</span></code> but it is good for clarity, and necessary if used inline in a train. One favourite is <code class="docutils literal notranslate"><span class="pre">,⍥⊂</span></code>prefer over {⍺ ⍵}</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "dyalog-kernel"
        },
        kernelOptions: {
            kernelName: "dyalog-kernel",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'dyalog-kernel'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="Variant.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Variant in depth <code class="docutils literal notranslate"><span class="pre">⍠</span></code></p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="ObjectOrientation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Object-oriented APL</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Adám Brudzewsky (edited by Stefan Kruger)<br/>
        
          <div class="extra_footer">
            <p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" />
</a></p>
<p>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>